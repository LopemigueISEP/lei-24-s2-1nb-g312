@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

'hide footbox
actor "GSM" as GSM
participant RegisterGreenSpaceUI as UI
participant RegisterGreenSpaceController as CTRL
participant ":Repositories" as RepositorySingleton
participant "repositories\n:Repositories" as PLAT
participant "employeeRepository:\nEmployeeRepository" as EMPLREP
participant "greenSpaceTypology\n:GreenSpaceTypology" as GreenSpaceTypology

participant "employee\n:Employee" as EMP
participant "green Space:\nGreen Space" as GREENSPACE
activate GSM

ref over GSM, UI : This action assumes that the user has already logged in

GSM -> UI : asks to register a new green space
activate UI
 UI -> CTRL: getGreenSpaceTypology()
        activate CTRL
            CTRL -> GreenSpaceTypology : getGreenSpaceTypology()
            activate GreenSpaceTypology
                GreenSpaceTypology -> CTRL: greenSpaceTypology
            deactivate GreenSpaceTypology
        CTRL -> UI : greenSpaceTypology
        deactivate CTRL
UI -> GSM : shows green space typology to be selected and requests data (name, address, area)

deactivate UI

GSM -> UI : selects green space typology and types requested data
activate UI

UI --> GSM : shows all data and requests confirmation
deactivate UI

GSM -> UI : confirms data
activate UI

UI -> CTRL : registerGreenSpace(name, address, area, typology, manager)
activate CTRL
CTRL->CTRL: getEmployeeFromRepository()

                activate CTRL
                CTRL -> RepositorySingleton : getInstance()
                activate RepositorySingleton

                RepositorySingleton --> CTRL : repositories
                deactivate RepositorySingleton

                CTRL -> PLAT : getEmployeeRepositories()
                activate PLAT


                PLAT --> CTRL : EmployeeRepositories
                deactivate PLAT


                CTRL -> EMPLREP: getEmployee()
                activate EMPLREP
                EMPLREP -->CTRL: employee
                deactivate EMPLREP

            CTRL-->CTRL: employee
            deactivate CTRL

            |||
            CTRL -> EMP : registerGreenSpace(name, address, area, typology, manager)
            activate EMP

            EMP ->GREENSPACE** : registerGreenSpace(name, address, area, typology, manager)

            EMP -> EMP: validateGreenSpace(name)
            EMP -> EMP: addGreenSpace(name)

            EMP --> CTRL: greenSpace
            deactivate EMP



            CTRL --> UI: greenSpace
            deactivate CTRL

            UI --> GSM: displays operation success
            deactivate UI

deactivate GSM
@enduml